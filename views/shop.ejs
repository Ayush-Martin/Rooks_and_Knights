<!DOCTYPE html>
<html lang="en">

<head>
	<%- include('./partials/head.ejs') %>
		<style>
			/* Custom Product Card UI */
			.product-card-custom {
				background: #fff;
				border-radius: 16px;
				overflow: hidden;
				box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
				transition: all 0.3s ease;
				height: 100%;
				border: 1px solid #f0f0f0;
				display: block;
				text-decoration: none;
				position: relative;
			}

			.product-card-custom:hover {
				transform: translateY(-5px);
				box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
				border-color: #333;
			}

			.product-img-wrapper {
				position: relative;
				padding-top: 100%;
				/* 1:1 Aspect Ratio */
				overflow: hidden;
				background: #f9f9f9;
			}

			.product-img-wrapper img {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				object-fit: cover;
				transition: transform 0.5s ease;
			}

			.product-card-custom:hover .product-img-wrapper img {
				transform: scale(1.08);
			}

			.product-details {
				padding: 20px;
			}

			.product-title {
				font-family: 'Poppins', sans-serif;
				font-size: 15px;
				font-weight: 600;
				color: #333;
				margin-bottom: 8px;
				white-space: nowrap;
				overflow: hidden;
				text-overflow: ellipsis;
				display: block;
				transition: color 0.3s;
			}

			.product-card-custom:hover .product-title {
				color: #000;
			}

			.product-rating {
				font-size: 13px;
				color: #f1c40f;
				margin-bottom: 10px;
				display: flex;
				align-items: center;
			}

			.product-rating i {
				margin-right: 2px;
			}

			.product-price {
				font-family: 'Poppins', sans-serif;
				font-size: 17px;
				font-weight: 700;
				color: #333;
				display: flex;
				align-items: center;
				gap: 8px;
			}

			.product-price .old-price {
				font-size: 14px;
				color: #999;
				text-decoration: line-through;
				font-weight: 400;
			}

			.product-price .discount-badge {
				font-size: 11px;
				background: #e74c3c;
				color: #fff;
				padding: 2px 6px;
				border-radius: 4px;
				font-weight: 600;
			}
		</style>
</head>

<body class="">

	<!-- Header -->
	<header class="header-v4">
		<%- include('./partials/header.ejs') %>
	</header>




	<!-- Product -->
	<div class="bg0 m-t-23 p-b-140">
		<div class="container">
			<div class="flex-w flex-sb-m p-b-52">

				<div class="flex-w flex-l-m filter-tope-group m-tb-10 ">
					<a class="stext-106 cl6 hov1 bor3 trans-04 m-r-32 m-tb-5 <%=(!categoryFilter)? 'text-primary':''%>"
						href="/shop?sortby=<%=sortbyFilter %>&&price=<%= priceFilter %>&&subCategory=<%= subCategoryFilter %>&&search=<%= searchFilter %>">
						All
					</a>

					<% categoryList.forEach(category=> { %>
						<a class="stext-106 cl6 hov1 bor3 trans-04 m-r-32 m-tb-5 <%=(categoryFilter==category._id)? 'text-primary':''%>"
							href="/shop?category=<%= category._id %>&&sortby=<%=sortbyFilter %>&&price=<%= priceFilter %>&&subCategory=<%= subCategoryFilter %>&&search=<%= searchFilter %>">
							<%= category.categoryName %>
						</a>
						<% }); %>

				</div>

				<div class="flex-w flex-c-m m-tb-10">
					<div
						class="flex-c-m stext-106 cl6 size-104 bor4 pointer hov-btn3 trans-04 m-r-8 m-tb-4 js-show-filter">
						<i class="icon-filter cl2 m-r-6 fs-15 trans-04 zmdi zmdi-filter-list"></i>
						<i class="icon-close-filter cl2 m-r-6 fs-15 trans-04 zmdi zmdi-close dis-none"></i>
						Filter
					</div>

					<div class="flex-c-m stext-106 cl6 size-105 bor4 pointer hov-btn3 trans-04 m-tb-4 js-show-search">
						<i class="icon-search cl2 m-r-6 fs-15 trans-04 zmdi zmdi-search"></i>
						<i class="icon-close-search cl2 m-r-6 fs-15 trans-04 zmdi zmdi-close dis-none"></i>
						Search
					</div>
				</div>

				<!-- Search product -->
				<div class="dis-none panel-search w-full p-t-10 p-b-15">
					<div class="bor8 dis-flex p-l-15">
						<button class="size-113 flex-c-m fs-16 cl2 hov-cl1 trans-04">
							<i class="zmdi zmdi-search"></i>
						</button>
						<a href="/shop" class="size-113 flex-c-m fs-16 cl2 hov-cl1 trans-04">
							<i class="fas fa-times"></i>
						</a>
						<form id="searchForm" action="/shop" method="get" class="w-full">
							<input class="mtext-107 cl2 size-114 plh2 p-r-15 w-full" type="text" id="searchInput"
								name="search" placeholder="Search..." autofocus>

						</form>
					</div>
				</div>

				<!-- Filter -->
				<div class="dis-none panel-filter w-full p-t-10">
					<div class="wrap-filter flex-w bg6 w-full p-lr-40 p-t-27 p-lr-15-sm">
						<div class="filter-col1 p-r-15 p-b-27">
							<div class="mtext-102 cl2 p-b-15">
								Sort By
							</div>

							<ul>

								<li class="p-b-6">
									<a href="/shop?category=<%= categoryFilter %>&&price=<%= priceFilter %>&&subCategory=<%= subCategoryFilter %>&&search=<%= searchFilter %>"
										class="filter-link stext-106 trans-04 <%=(!sortbyFilter)? 'filter-link-active':''%>">
										Popularity
									</a>
								</li>

								<li class="p-b-6">
									<a href="#" class="filter-link stext-106 trans-04">
										Average rating
									</a>
								</li>

								<li class="p-b-6">
									<a href="/shop?category=<%= categoryFilter %>&&sortby=newArrivals&&price=<%= priceFilter %>&&subCategory=<%= subCategoryFilter %>&&search=<%= searchFilter %>"
										class="filter-link stext-106 trans-04 <%=(sortbyFilter=='newArrivals')? 'filter-link-active':''%>">
										New Arrivals
									</a>
								</li>

								<li class="p-b-6">
									<a href="/shop?category=<%= categoryFilter %>&&sortby=priceLowToHeigh&&price=<%= priceFilter %>&&subCategory=<%= subCategoryFilter %>&&search=<%= searchFilter %>"
										class="filter-link stext-106 trans-04 <%=(sortbyFilter=='priceLowToHeigh')? 'filter-link-active':''%>">
										Price: Low to High
									</a>
								</li>

								<li class="p-b-6">
									<a href="/shop?category=<%= categoryFilter %>&&sortby=priceHeighToLow&&price=<%= priceFilter %>&&subCategory=<%= subCategoryFilter %>&&search=<%= searchFilter %>"
										class="filter-link stext-106 trans-04 <%=(sortbyFilter=='priceHeighToLow')? 'filter-link-active':''%>">
										Price: High to Low
									</a>
								</li>

								<li class="p-b-6">
									<a href="/shop?category=<%= categoryFilter %>&&sortby=aA-zZ&&price=<%= priceFilter %>&&subCategory=<%= subCategoryFilter %>&&search=<%= searchFilter %>"
										class="filter-link stext-106 trans-04 <%=(sortbyFilter=='aA-zZ')? 'filter-link-active':''%>">
										aA-zZ
									</a>
								</li>

								<li class="p-b-6">
									<a href="/shop?category=<%= categoryFilter %>&&sortby=zZ-aA&&price=<%= priceFilter %>&&subCategory=<%= subCategoryFilter %>&&search=<%= searchFilter %>"
										class="filter-link stext-106 trans-04 <%=(sortbyFilter=='zZ-aA')? 'filter-link-active':''%>">
										zZ-aA
									</a>
								</li>
							</ul>
						</div>

						<div class="filter-col2 p-r-15 p-b-27">
							<div class="mtext-102 cl2 p-b-15">
								Price
							</div>

							<ul>
								<li class="p-b-6">
									<a href="/shop?category=<%= categoryFilter %>&&sortby=<%= sortbyFilter %>&&subCategory=<%= subCategoryFilter %>&&search=<%= searchFilter %>"
										class="filter-link stext-106 trans-04  <%=(!priceFilter)? 'filter-link-active':''%>">
										All
									</a>
								</li>

								<li class="p-b-6">
									<a href="/shop?category=<%= categoryFilter %>&&sortby=<%= sortbyFilter %>&&price=0-1000&&subCategory=<%= subCategoryFilter %>&&search=<%= searchFilter %>"
										class="filter-link stext-106 trans-04 <%=(priceFilter=='0-1000')? 'filter-link-active':''%>">
										₹0 - ₹1000
									</a>
								</li>

								<li class="p-b-6">
									<a href="/shop?category=<%= categoryFilter %>&&sortby=<%= sortbyFilter %>&&price=1000-2000&&subCategory=<%= subCategoryFilter %>&&search=<%= searchFilter %>"
										class="filter-link stext-106 trans-04 <%=(priceFilter=='1000-2000')? 'filter-link-active':''%>">
										₹1000 - ₹2000
									</a>
								</li>

								<li class="p-b-6">
									<a href="/shop?category=<%= categoryFilter %>&&sortby=<%= sortbyFilter %>&&price=2000-3000&&subCategory=<%= subCategoryFilter %>&&search=<%= searchFilter %>"
										class="filter-link stext-106 trans-04 <%=(priceFilter=='2000-3000')? 'filter-link-active':''%>">
										₹2000 - ₹3000
									</a>
								</li>

								<li class="p-b-6">
									<a href="/shop?category=<%= categoryFilter %>&&sortby=<%= sortbyFilter %>&&price=3000-4000&&subCategory=<%= subCategoryFilter %>&&search=<%= searchFilter %>"
										class="filter-link stext-106 trans-04 <%=(priceFilter=='3000-4000')? 'filter-link-active':''%>">
										₹3000 - ₹4000
									</a>
								</li>

								<li class="p-b-6">
									<a href="/shop?category=<%= categoryFilter %>&&sortby=<%= sortbyFilter %>&&price=4000+&&subCategory=<%= subCategoryFilter %>&&search=<%= searchFilter %>"
										class="filter-link stext-106 trans-04 <%=(priceFilter=='4000+')? 'filter-link-active':''%>">
										₹4000+
									</a>
								</li>
							</ul>
						</div>


						<div class="filter-col4 p-b-27">
							<div class="mtext-102 cl2 p-b-15">
								Sub categories
							</div>

							<div class="flex-w p-t-4 m-r--5">

								<a href="/shop?category=<%= categoryFilter %>&&sortby=<%= sortbyFilter %>&&price=<%= priceFilter %>&&search=<%= searchFilter %>"
									class="flex-c-m stext-107 cl6 size-301 bor7 p-lr-15 hov-tag1 trans-04 m-r-5 m-b-5 <%=(!subCategoryFilter)? 'click-tag1':''%>">
									All
								</a>
								<% subCategoryList.forEach(subCategory=> { %>
									<a href="/shop?category=<%= categoryFilter %>&&sortby=<%= sortbyFilter %>&&price=<%= priceFilter %>&&subCategory=<%= subCategory._id %>&&search=<%= searchFilter %>"
										class="flex-c-m stext-107 cl6 size-301 bor7 p-lr-15 hov-tag1 trans-04 m-r-5 m-b-5 <%=(subCategoryFilter==subCategory._id)? 'click-tag1':''%>">
										<%= subCategory.subCategoryName %>
									</a>
									<% }); %>
							</div>
						</div>
						<div class="filter-col4 p-b-27">
							<a href="/shop" class="mtext-102 cl2 p-b-15">Clear</a>
						</div>

					</div>
				</div>

			</div>



			<div class="row isotope-grid">
				<% productList.forEach((product)=> {%>
					<div class="col-sm-6 col-md-4 col-lg-3 p-b-35 isotope-item women">
						<a href="/shop/product/<%= product._id %>" class="product-card-custom">
							<div class="product-img-wrapper">
								<img src="<%= product.productImage1 %>" alt="<%= product.productName %>">
							</div>
							<div class="product-details">
								<span class="product-title">
									<%= product.productName %>
								</span>

								<div class="product-rating">
									<% let sum=0 %>
										<% product.reviews.forEach(element=> { sum+=element.ratingStar }); %>
											<% let average=product.reviews.length> 0 ? sum/product.reviews.length : 0 %>

												<% for(let i=0; i<5; i++){ %>
													<% if(i < Math.round(average)) { %>
														<i class="zmdi zmdi-star"></i>
														<% } else { %>
															<i class="zmdi zmdi-star-outline"
																style="color: #e0e0e0;"></i>
															<% } %>
																<% } %>
																	<span class="text-muted small ms-1"
																		style="font-size: 11px;">(<%=
																			product.reviews.length %>)</span>
								</div>

								<div class="product-price">
									<% if(product.offer || product.categoryID.offer || product.subCategoryID.offer) {%>
										<span class="old-price">₹<%= product.price %></span>
										<span>₹<%=parseInt( product.price- product.price *
												Math.max(product.offer,product.categoryID.offer,product.subCategoryID.offer)/100
												)%></span>
										<% }else{ %>
											<span>₹<%= product.price %></span>
											<% } %>
								</div>
							</div>
						</a>
					</div>
					<% }) %>
			</div>

			<div class="flex-c-m flex-w w-full p-t-45 gap-10">
				<!-- Previous Button -->
				<a href="/shop?category=<%= categoryFilter %>&&sortby=<%= sortbyFilter %>&&price=<%= priceFilter %>&&subCategory=<%= subCategoryFilter %>&&search=<%= searchFilter %>&&page=<%= (currentPage>1)? Number(currentPage)-1:1 %>"
					class="m-r-20 text-dark">
					<i class="fas fa-chevron-left"></i> Previous
				</a>
				<P class="m-r-20 text-dark">page : <%= currentPage %> of <%= totalNoOfPages %>
				</P>
				<!-- Next Button -->
				<a href="/shop?category=<%= categoryFilter %>&&sortby=<%= sortbyFilter %>&&price=<%= priceFilter %>&&subCategory=<%= subCategoryFilter %>&&search=<%= searchFilter %>&&page=<%= (currentPage<totalNoOfPages)? Number(currentPage)+1:currentPage %>"
					class=" text-dark">
					Next <i class="fas fa-chevron-right"></i>
				</a>
			</div>

		</div>
	</div>


	<!-- Footer -->
	<footer class="bg3 p-t-75 p-b-32">
		<%- include('./partials/footer.ejs') %>
	</footer>


	<%- include('./partials/backToTop.ejs') %>


		<%- include('./partials/scriptBody.ejs') %>


			<script>
				document.addEventListener('DOMContentLoaded', () => {
					const searchForm = document.getElementById('searchForm');
					const searchInput = document.getElementById('searchInput');

					searchInput.addEventListener('keydown', (event) => {
						if (event.key === 'Enter') {
							event.preventDefault();
							searchForm.submit(); // Submit the form programmatically
						}
					});
				});
			</script>

</body>

</html>